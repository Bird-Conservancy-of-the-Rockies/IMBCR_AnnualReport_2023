<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="26-analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="26-analysis_files/libs/quarto-html/quarto.js"></script>
<script src="26-analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="26-analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="26-analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="26-analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="26-analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="26-analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="26-analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="26-analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="indices" class="level3">
<h3 class="anchored" data-anchor-id="indices">Indices</h3>
<p>The following indices are used in all model descriptions:</p>
<p><span class="math inline">\(i\)</span> - strata with max <span class="math inline">\(I\)</span></p>
<p><span class="math inline">\(j\)</span> - grid cells with max <span class="math inline">\(J\)</span></p>
<p><span class="math inline">\(k\)</span> - points within a grid cell with max <span class="math inline">\(K=16\)</span>, and <span class="math inline">\(K_{[s]}\)</span> is the number of points surveyed in grid cell <span class="math inline">\(j\)</span></p>
<p><span class="math inline">\(l\)</span> - Bird Conservation Regions with max <span class="math inline">\(L\)</span></p>
<p><span class="math inline">\(d\)</span> - distance bins with max <span class="math inline">\(d_{[max]}=10\)</span></p>
<p><span class="math inline">\(d_{[mid]}\)</span>, <span class="math inline">\(d_{[low]}\)</span>, and <span class="math inline">\(d_{[high]}\)</span> are the distance mid-point, lower bound, and upper bound for distance bin <span class="math inline">\(d\)</span>. <span class="math inline">\(d_{[max,high]}\)</span> is the upper bound for the furthest distance bin (i.e., the radius of the entire point-level plot).</p>
<p><span class="math inline">\(r\)</span> – 2-min time removal bins within the 6-min survey with max <span class="math inline">\(R=3\)</span></p>
<p><span class="math inline">\(t\)</span> – years with max <span class="math inline">\(T\)</span></p>
<p><span class="math inline">\(m\)</span> – posterior samples</p>
</section>
<section id="hurdle-model" class="level3">
<h3 class="anchored" data-anchor-id="hurdle-model">Hurdle model</h3>
<p><strong><em>State process</em></strong></p>
<p>We model species occupancy of grid cells as</p>
<p><span id="eq-hurdle_z"><span class="math display">\[\begin{equation}z_{ijt} \sim Bernoulli(ψ_{it})\end{equation} \tag{1}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_psi"><span class="math display">\[\begin{equation}logit(ψ_{it}) \sim Normal(μ_{[ψ],t},SD_{[ψ],t}^{2})\end{equation} \tag{2}\]</span></span></p>
<p>where <span class="math inline">\(ψ_{it}\)</span> is the probability of species occupancy of a grid cell in stratum <span class="math inline">\(i\)</span> in year <span class="math inline">\(t\)</span>, <span class="math inline">\(z_{ijt}\)</span> is the latent occupancy state of grid cell <span class="math inline">\(j\)</span> in stratum <span class="math inline">\(i\)</span> during year <span class="math inline">\(t\)</span>, and <span class="math inline">\(μ_{[ψ],t}\)</span> and <span class="math inline">\(SD_{[ψ],t}^{2}\)</span> are year-specific mean and variance hyper-parameters. We exclude data for all strata in which the species was never detected (effectively conditioning occupancy on being within the species range). We model species occupancy of points within an occupied grid cell as</p>
<p><span id="eq-hurdle_u"><span class="math display">\[\begin{equation}u_{ijt}|z_{ijt} \sim Binomial(K,θ_{it}×z_{ijt})\end{equation} \tag{3}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_theta"><span class="math display">\[\begin{equation}logit(θ_{it}) \sim Normal(μ_{[θ],t},SD_{[θ],t}^{2}),\end{equation} \tag{4}\]</span></span></p>
<p>where <span class="math inline">\(θ_{it}\)</span> is the probability of species occupancy of a point within an occupied grid cell in stratum <span class="math inline">\(i\)</span> and year <span class="math inline">\(t\)</span>, <span class="math inline">\(u_{ijt}\)</span> is the latent occupancy state describing the number of points occupied within grid cell <span class="math inline">\(j\)</span>, stratum <span class="math inline">\(i\)</span>, and year <span class="math inline">\(t\)</span>, and <span class="math inline">\(μ_{[θ],t}\)</span> and <span class="math inline">\(SD_{[θ],t}^{2}\)</span> are year-specific mean and variance hyper-parameters. We model abundance of independent clusters of individuals within <span class="math inline">\(d_{[max,high]}\)</span> of points within a grid cell as</p>
<p><span id="eq-hurdle_N"><span class="math display">\[\begin{equation}N_{ijt} \sim Poisson(λ_{ijt}×u_{ijt})+u_{ijt}\end{equation} \tag{5}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_lambda"><span class="math display">\[\begin{equation}log(λ_{ijt})=α_{it}+ε_{jt}\end{equation} \tag{6}\]</span></span></p>
<p>where <span class="math inline">\(α_{it}\)</span> and <span class="math inline">\(ε_{jt}\)</span> are stratum- and grid-cell-specific random effects, respectively, and <span class="math inline">\(α_{it}\)</span> is also subject to a fixed effect of year:</p>
<p><span id="eq-hurdle_alpha"><span class="math display">\[\begin{equation}α_{it} \sim Normal(μ_{[α],t},SD_{[α],t}^{2})\end{equation} \tag{7}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_epsilon"><span class="math display">\[\begin{equation}ε_{it} \sim Normal(0,SD_{[ε]}^{2}).\end{equation} \tag{8}\]</span></span></p>
<p>We derive density, D, as</p>
<p><span id="eq-hurdle_D"><span class="math display">\[\begin{equation}D_{ijt}= \frac{N_{ijt}×s}{K×∑_{d=1}^{d_{[max]}}A_{d}},\end{equation} \tag{9}\]</span></span></p>
<p>where <span class="math inline">\(K×∑_{d=1}^{d_{[max]}}A_{d}\)</span> is the effective area (<span class="math inline">\(km^{2}\)</span>) of estimation for a grid cell and <span class="math inline">\(s\)</span> is the mean cluster size for independent detections, which is sampled from the distribution</p>
<p><span id="eq-hurdle_s"><span class="math display">\[\begin{equation}s \sim Gamma(k,v)+1,\end{equation} \tag{10}\]</span></span></p>
<p>where k and v are derived from the mean and variance of observed cluster sizes. We subtract 1 from the mean when calculating k and v and add 1 to the random variable to ensure cluster sizes were <span class="math inline">\(&gt;1\)</span>. We derive stratum-level density estimates by averaging all <span class="math inline">\(D_{ijt}\)</span> within each stratum, and we take the area-weighted average of strata estimates to obtain superstrata density and occupancy estimates.</p>
<p><strong><em>Observation process</em></strong></p>
<p>We model the sum of observed counts (of independent clusters of individuals) across all points surveyed within a grid cell (<span class="math inline">\(n_{ijtl}\)</span>) and the number of points where the species was detected (<span class="math inline">\(y_{ijtl}\)</span>) as</p>
<p><span id="eq-hurdle_n"><span class="math display">\[\begin{equation}n_{ijtl} \sim Binomial\biggl(N_{ijt},p_{[a],tl}×p_{[p],t}×\biggl(\frac{K_{[s],ijt}}{K}\biggr)\biggr),\end{equation} \tag{11}\]</span></span></p>
<p><span id="eq-hurdle_y"><span class="math display">\[\begin{equation}y_{ijtl} \sim Binomial\biggl(u_{ijt},p_{[s],tl}×\biggl(\frac{K_{[s],ijt}}{K}\biggr)\biggr)\end{equation},~\mathrm{and} \tag{12}\]</span></span></p>
<p><span id="eq-hurdle_p_s"><span class="math display">\[\begin{equation}p_{[s],tl}=1-(1-p_{[a],tl}×p_{[p],t})^{N_{ijt}}\end{equation}, \tag{13}\]</span></span></p>
<p>where <span class="math inline">\(p_{[a],tl}\)</span> is a year- and BCR-specific availability component of detection probability, <span class="math inline">\(p_{[p],t}\)</span> is a year-specific perceptibility component of detection probability, <span class="math inline">\(K_{[s],ijt}⁄K\)</span> is survey effort, and <span class="math inline">\(p_{[s],tl}\)</span> is the probability of detecting the species at an occupied point. Detection components summarize probability vectors,</p>
<p><span id="eq-hurdle_p_a"><span class="math display">\[\begin{equation}p_{[a],tl}=∑_{r=1}^{R} \mathbf{π_{[a],tl}} \end{equation} \tag{14}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_p_p"><span class="math display">\[\begin{equation}p_{[p],tl}=∑_{d=1}^{d_{max}} \mathbf{π_{[p],tl}} \end{equation}, \tag{15}\]</span></span></p>
<p>consisting of multinomial cell probabilities for</p>
<p><span id="eq-hurdle_pi_a"><span class="math display">\[\begin{equation}\mathbf{y_{[a],ijtl}} \sim Multinomial \biggl(n_{ijt},\mathbf{π_{[a],tl}^{[c]}} \biggr)\end{equation} \tag{16}\]</span></span></p>
<center>
and
</center>
<p><span id="eq-hurdle_pi_p"><span class="math display">\[\begin{equation}\mathbf{y_{[p],ijtl}} \sim Multinomial \biggl(n_{ijt},\mathbf{π_{[p],tl}^{[c]}} \biggr)\end{equation}, \tag{17}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{y_{[a],ijtl}}\)</span> and <span class="math inline">\(\mathbf{y_{[p],ijt}}\)</span> are vectors of counts within time removal and distance bins, respectively. Cell probabilities for availability assume constant availability across the survey period, <span id="eq-hurdle_pi_a_cell"><span class="math display">\[\begin{equation}π_{[a],trl}=p_{[ar],tl} (1-p_{[ar],tl})^{r-1}\end{equation}, \tag{18}\]</span></span> and are scaled to sum to 1,</p>
<p><span id="eq-hurdle_pi_a_cell_c"><span class="math display">\[\begin{equation}π_{[a],trl}^{[c]}=π_{[a],trl}⁄p_{[a],tl} \end{equation}, \tag{19}\]</span></span></p>
<p>where <span class="math inline">\(p_{[ar],tl}\)</span> is the availability for a single 2-min time removal bin. Surveys in 2008-2009 were 5 min instead of 6 min in length, so for these years, we calculate the availability for a 1-min interval, <span class="math inline">\(p_{[a1],tl}=1-\biggl((1-p_{[ar],tl})^3\biggr)^{1/6}\)</span>, and then calculate the unscaled cell probability for the third (1 min) period as <span class="math inline">\(π_{[a],(t≤2)(r=3)l}=p_{[a1],tl}×(1-p_{[ar],tl})^{r-1}\)</span>. Cell probabilities for perceptibility account for area of bins with increasing distance:</p>
<p><span id="eq-hurdle_pi_p_cell"><span class="math display">\[\begin{equation}π_{[p],td}=\frac{p_{[pd],td}A_d}{∑_{d=1}^{d_{[max]}}A_d}\end{equation},~\mathrm{and} \tag{20}\]</span></span></p>
<p><span id="eq-hurdle_pi_p_cell_c"><span class="math display">\[\begin{equation}π_{[p],td}^{[c]}=π_{[p],td}⁄p_{[p],t}\end{equation}, \tag{21}\]</span></span></p>
<p>where <span class="math inline">\(p_{[pd],td}\)</span> is the perceptibility within distance bin <span class="math inline">\(d\)</span> in year <span class="math inline">\(t\)</span>, and <span class="math inline">\(A_d\)</span> is the area of distance bin <span class="math inline">\(d\)</span>. We model <span class="math inline">\(p_{[pd],td}\)</span> using one of four possible perceptibility models: 1) a half-normal constant model, 2) a hazard rate constant model, 3) a half-normal year model, and 4) a hazard rate year model. For half-normal functions, we calculated $p_{[pd],td} for each distance class as:</p>
<p><span id="eq-hurdle_p_pd_HN"><span class="math display">\[\begin{equation}p_{[pd],td}=\frac{2\pi\int_{c=d_{[low]}}^{c=d_{[high]}}exp\biggl(-\biggl(\frac{c^2}{2\sigma_{t^2}}\biggr)\biggr)c~dc}{A_d} \end{equation}, \tag{22}\]</span></span></p>
<p>where <span class="math inline">\(d_{[low]}\)</span> and <span class="math inline">\(d_{[high]}\)</span> are the bounds for distance bin <span class="math inline">\(d\)</span> and <span class="math inline">\(σ_t\)</span> is the half-normal shape parameter. Because of the lack of an analytical solution to the integral of the hazard rate function, we calculated <span class="math inline">\(p_{[pd],td}\)</span> at the midpoint, <span class="math inline">\(d_{[mid]}\)</span>, of each distance class:</p>
<p><span id="eq-hurdle_p_pd_HZ"><span class="math display">\[\begin{equation}p_{[pd],td}=1-exp\biggl(-\biggl(\frac{d_{[mid]}}{h_t}\biggr)^b\biggr)\end{equation}, \tag{23}\]</span></span></p>
<p>where <span class="math inline">\(h_t\)</span> and <span class="math inline">\(b\)</span> are estimated parameters for the hazard function. For perceptibility models <span class="math inline">\(\eqref{#eq:hurdle_p_pd_HN}\)</span> and <span class="math inline">\(\@eqref{#eq:hurdle_p_pd_HZ}\)</span>, we draw year-specific shape parameters from hyperdistributions:</p>
<p>………………………………………………………………………………………………..</p>
<p>The number of independent clusters of individuals, <span class="math inline">\(N\)</span>, of a given species at point count location <span class="math inline">\(k\)</span> in grid <span class="math inline">\(j\)</span>, stratum <span class="math inline">\(i\)</span>, and year <span class="math inline">\(t\)</span> came from a Poisson distribution</p>
<p><span class="math display">\[N_{ijkt}\sim Poisson(λ_{ijt}×z_{ijkt})\]</span></p>
<p>with mean <span class="math inline">\(λ_{ijt}\)</span>. Abundances at all points within a grid came from a distribution with the same mean to account for the lack of independence between points, and we modeled <span class="math inline">\(λ\)</span> as a function of time to estimate trend for each stratum:</p>
<p><span class="math display">\[log⁡(λ_{ijt}) = α_{i}+r_{i} (t-1)+ε_{j},\]</span></p>
<p>where <span class="math inline">\(α\)</span> and <span class="math inline">\(r\)</span> are stratum-specific intercepts and trends, respectively, and <span class="math inline">\(ε\)</span> is a grid-specific random effect.</p>
<p>To avoid predicting species occurrence outside of observed ranges, we fixed <span class="math inline">\(ψ\)</span> to 0 for all strata in which the species was never observed and used a prior informed by the observed proportion of grid-year combinations in a stratum in which the species was detected</p>
<p><span class="math display">\[logit(ψ_{i }) \sim Normal(μ_{ψ_i},σ_{ψ}^{2}),\]</span></p>
<p>where <span class="math inline">\(μ_{ψ_i}\)</span> is the stratum-specific naïve occupancy and <span class="math inline">\(σ_{ψ}^{2}\)</span> is the annual variation in occupancy probabilities shared across strata. All other parameters had vague priors:</p>
<p><span class="math display">\[α\sim Normal(0,4),\]</span> <span class="math display">\[exp⁡(r) \sim Uniform(0.25,1.75),\]</span></p>
<p><span class="math display">\[ε\sim Normal(0,σ_{ε}^{2}),\]</span></p>
<p>and</p>
<p><span class="math display">\[σ_{ε}^{2}\sim Uniform(0,5).\]</span></p>
<p>We derived density, <span class="math inline">\(D\)</span>, at the point count location as</p>
<p><span class="math display">\[D_{ijkt} = \frac {(N_{ijkt}×s)}{A_{c}} ,\]</span></p>
<p>where <span class="math inline">\(A_{c}\)</span> is the area of the point count circle (see Observation process section below) and s is the cluster size, which was sampled from the distribution</p>
<p><span class="math display">\[s\sim Gamma(k,θ)+1,\]</span></p>
<p>where <span class="math inline">\(k\)</span> and <span class="math inline">\(θ\)</span> were derived from the mean and variance of observed cluster sizes. We subtracted 1 from the mean when calculating <span class="math inline">\(k\)</span> and <span class="math inline">\(θ\)</span> and added 1 to the random variable to ensure cluster sizes were <span class="math inline">\(\ge\)</span> 1. We derived stratum-level density estimates by averaging all point-level density estimates within each stratum, and we took the area-weighted average of strata estimates to obtain superstrata estimates. We required a minimum of 30 detections across the IMBCR effort to estimate density for each species.</p>
<p><strong>Observation process</strong></p>
<p>We estimated the probability of detecting an independent cluster of individuals by fitting distance functions to the distance data collected during surveys (Buckland et al.&nbsp;2001). We fit four detection models including: 1. half-normal constant <span class="math inline">\((HN(.))\)</span><br>
2. hazard rate constant <span class="math inline">\((Haz(.))\)</span><br>
3. half-normal year <span class="math inline">\((HN(t))\)</span><br>
4. hazard rate year <span class="math inline">\((Haz(t))\)</span>.</p>
<p>We removed the furthest 10% of observed detection distances from the data set and binned the remaining detections into 10 evenly spaced distance classes. For half-normal functions, we calculated the detection probability, <span class="math inline">\(p\)</span>, for each distance class, l, as:</p>
<p><span class="math display">\[p_{l} = \frac {(2π∫_{c=b_{l}}^{c=b_{l+1}}exp⁡(-(\frac {c^2}{2θ^2} ))c dc)}{A_l}\]</span></p>
<p>where <span class="math inline">\(b_{l}\)</span> and <span class="math inline">\(b_{l+1}\)</span> are the cutpoints for <span class="math inline">\(l\)</span>, <span class="math inline">\(θ\)</span> is the half-normal shape parameter, and <span class="math inline">\(A_{l}\)</span> is the area of <span class="math inline">\(l\)</span>. Because of the lack of an analytical solution to the integral of the hazard rate function, we calculated <span class="math inline">\(p\)</span> at the midpoint, <span class="math inline">\(m\)</span>, of each distance class</p>
<p><span class="math display">\[p_{l} = 1-exp⁡ (-(\frac{ m_{l}}{a})^{b} )\]</span>*</p>
<p>To allow detection probabilities to vary by year, we sampled year-specific shape parameters from hyperdistributions:</p>
<p><span class="math display">\[θ_{t}\sim Normal(μ_{θ},σ_{θ}^{2} ),\]</span></p>
<p><span class="math display">\[a_{t}\sim Normal(μ_{a},σ_{a}^{2} ),\]</span></p>
<p>and</p>
<p><span class="math display">\[b_{t}\sim Normal(μ_{b},σ_{b}^{2} ),\]</span></p>
<p>with priors of</p>
<p><span class="math display">\[μ_{θ}\sim Unif(0,1000),\]</span> <span class="math display">\[μ_{a}\sim Unif(0,500),\]</span></p>
<p><span class="math display">\[σ_{θ},σ_{a},μ_{b}\sim Unif(0,100),\]</span></p>
<p>and</p>
<p><span class="math display">\[σ_{b}\sim Unif(0,25).\]</span></p>
<p>We then multiplied p_l by the proportional area of l to account for the probability that a cluster is within distance class l and obtain π_l, the probability a cluster is present within distance class l and is detected,</p>
<p><span class="math display">\[π_{lt} = \frac {p_{lt} A_{l}}{∑_{l=1}^{L}A_{l}}.\]</span></p>
<p>We calculated the overall capture probability, <span class="math inline">\(p_{cap}\)</span>, as</p>
<p><span class="math display">\[p_{cap} = ∑_{l=1}^{L}π_{l} ,\]</span></p>
<p>and modeled the number of detections in each distance class at each point count location in year <span class="math inline">\(t\)</span> as</p>
<p><span class="math display">\[y_{ijkt}\sim Multinom(π_{t},N_{ijkt} ).\]</span></p>
<p><strong><em>Detection model selection</em></strong></p>
<p>To find the most parsimonious detection function while minimizing computing time, we fit detection-only models to the distance data, using the four model structures described above. We used the Watanabe-Akaike Information Criterion (WAIC; Watanabe 2010, Hooten and Hobbs 2015) to select the most parsimonious detection structure and then used that structure for detection probabilities in the full model to estimate density and abundance.</p>
<p><strong><em>Superstratum trends</em></strong></p>
<p>We developed a post-hoc approach to estimate trends for superstrata. Using the rolled-up estimates of density for superstratum, i, we fit a general linear model (GLM) to the samples from each Bayesian iteration, m,</p>
<p><span class="math display">\[log⁡(\hat{D}_{itm} )\sim α_{im}+r_{im} (t-1).\]</span> Fitting a GLM across iterations allowed us to incorporate uncertainty in trends due to uncertainty around density estimates, but it did not account for temporal variation. To incorporate this second form of variation, we sampled a random intercept <span class="math inline">\((α_{im})\)</span> and slope <span class="math inline">\((\tilde{r}_{im})\)</span> for each iteration using the mean and standard error estimated using the GLM and made inference on the distribution of the resampled values,</p>
<p><span class="math display">\[\tilde{α}_{im} \sim Normal(μ_{α_{im}},SE_{α_{im}})\]</span></p>
<p>and</p>
<p><span class="math display">\[\tilde{r}_{im}\sim Normal(μ_{r_{im}},SE_{r_{im}}).\]</span></p>
</section>
<section id="occupancy-estimation" class="level3">
<h3 class="anchored" data-anchor-id="occupancy-estimation">Occupancy Estimation</h3>
<p>Occupancy estimation is most commonly used to quantify the proportion of sample units (i.e., 1 km² cells) occupied by an organism (MacKenzie et al., 2002). The application of occupancy modeling requires multiple surveys of the sample unit in space or time to estimate a detection probability (MacKenzie et al., 2006). The detection probability adjusts the proportion of sites occupied to account for species that were present but undetected (MacKenzie et al., 2002). We used a removal design (MacKenzie et al., 2006) to estimate a detection probability for each species, in which we binned minutes one and two, minutes three and four, and minutes five and six to meet the assumption of a monotonic decline in the detection rates through time. After the target species was detected at a point, we set all subsequent sampling intervals at that point to “missing data” (MacKenzie et al., 2006). We required a minimum of ≥1 detection on 10 different transects across the IMBCR effort to estimate occupancy for each species.</p>
<p>The 16 points in each sampling unit served as spatial replicates for estimating the proportion of points occupied within the sampled sampling units. We used a Bayesian, multi-scale occupancy model (Nichols et al.&nbsp;2008, Mordecai et al.&nbsp;2011, Green et al.&nbsp;2019) to estimate 1) the probability of detecting a species given presence (<span class="math inline">\(p\)</span>), 2) the proportion of points occupied by a species given presence within sampled sampling units (<span class="math inline">\(θ\)</span>) and 3) the proportion of sampling units occupied by a species (<span class="math inline">\(ψ\)</span>).</p>
<p>We truncated the data, using only detections &lt;125 m from the sample points, except for species in Accipitriformes, Anseriformes, Falconiformes, Galliformes, Gruiformes, Pelecaniformes, Podicepidiformes, and Suliformes for which we used the maximum observed distance for each species. Truncating the data allowed us to use bird detections over a consistent plot size and ensured that the points were independent (points were spread 250 m apart), which in turn allowed us to estimate <span class="math inline">\(θ\)</span> (the proportion of points occupied within each sampling unit) (Pavlacky Jr., Blakesley, White, Hanni, &amp; Lukacs, 2012). The interpretation of <span class="math inline">\(θ\)</span> for species for which we used maximum distances changes from occupancy to use because point count buffers overlap, but we chose this approach to provide estimates for a larger number of species.</p>
<p>We expected regional differences in the behavior, habitat use, and local abundance of species would correspond to regional variation in detection and the fraction of occupied points. Therefore, we estimated the proportion of sampling units occupied (<span class="math inline">\(ψ\)</span>) for each stratum by estimating BCR by year specific estimates of detection (<span class="math inline">\(p\)</span>) and point-level occupancy (<span class="math inline">\(θ\)</span>). We fixed <span class="math inline">\(p\)</span> and <span class="math inline">\(θ\)</span> to <span class="math inline">\(0\)</span> for BCRs in which a particular species was never detected. Otherwise these parameters came from hyperdistributions,</p>
<p><span class="math display">\[logit(p_{BCR,t}) \sim Normal(μ_{p_{BCR}},σ_{p}^{2})\]</span></p>
<p>and</p>
<p><span class="math display">\[logit(θ_{BCR,t})\sim Normal(μ_{θ_{BCR}},σ_{θ}^{2}),\]</span></p>
<p>where <span class="math inline">\(μ_{p}\)</span> and <span class="math inline">\(μ_{θ}\)</span> are BCR-specific means for detection and point-level occupancy, respectively, and <span class="math inline">\(σ_{p}^{2}\)</span> and <span class="math inline">\(σ_{θ}^{2}\)</span> are the annual variances shared across BCRs.</p>
<p>We fixed <span class="math inline">\(ψ\)</span> to 0 for all strata in which the species was never detected. Otherwise, the true occupancy state <span class="math inline">\((z_{i,t})\)</span> of a 1-km2 grid cell, <span class="math inline">\(j\)</span>, in a given year, <span class="math inline">\(t\)</span>, in stratum <span class="math inline">\(i\)</span> was modeled as</p>
<p><span class="math display">\[z_{ijt}\sim Bernoulli(ψ_{it})\]</span></p>
<p>and</p>
<p><span class="math display">\[logit(ψ_{it} )\sim Normal(μ_{ψ_i},σ_{ψ}^{2}),\]</span></p>
<p>where <span class="math inline">\(μ_{ψ_i}\)</span> is the stratum-specific mean occupancy rate on the logit scale and <span class="math inline">\(σ_{ψ}^{2}\)</span> is the annual variance shared across all strata. As with density, we took an area-weighted mean of stratum-level occupancy estimates (i.e., <span class="math inline">\(ψ\)</span>) to estimate superstratum-level occupancy probabilities.</p>
<p>The true point-level occupancy state (<span class="math inline">\(u\)</span>) was conditional on the grid-cell-level occupancy state (i.e., z = 1, occupied; z = 0, unoccupied), such that a point could only be occupied if the grid cell was occupied,</p>
<p><span class="math display">\[u_{ijkt}\sim Bernoulli(θ_{BCR,t}×z_{ijt}).\]</span></p>
<p>Finally, we modeled the observation process conditional on the point being occupied (i.e., <span class="math inline">\(u\)</span> = 1) as</p>
<p><span class="math display">\[y_{ijkt}\sim Binomial(p_{BCR,t}×u_{ijkt},J_{ijkt}),\]</span></p>
<p>where y_ijkt are the observation data at point <span class="math inline">\(k\)</span> in year <span class="math inline">\(t\)</span> (<span class="math inline">\(y\)</span> =1, observed; <span class="math inline">\(y\)</span> = 0, not observed) and <span class="math inline">\(J_{ijkt}\)</span> is the 2-minute interval in which the species was first detected (i.e., <span class="math inline">\(J\)</span> = 1, 1-2 minutes, <span class="math inline">\(J\)</span> = 2, 3-4 minutes, <span class="math inline">\(J\)</span> =3, 5-6 minutes or not detected).</p>
<p>Our application of the multi-scale model was analogous to a within-season robust design (Pollock, 1982) where the two-minute intervals at each point were the secondary samples for estimating <span class="math inline">\(p\)</span> and the points were the primary samples for estimating <span class="math inline">\(θ\)</span> (Nichols et al., 2008; Pavlacky Jr.&nbsp;et al., 2012). We considered both <span class="math inline">\(p\)</span> and <span class="math inline">\(θ\)</span> to be nuisance variables that were important for generating unbiased estimates of <span class="math inline">\(ψ\)</span>. <span class="math inline">\(θ\)</span> can be considered an availability parameter or the probability a species was present and available for sampling at the points (Nichols et al., 2008; Pavlacky Jr.&nbsp;et al., 2012).</p>
</section>
<section id="automated-analysis" class="level3">
<h3 class="anchored" data-anchor-id="automated-analysis">Automated Analysis</h3>
<p>We updated our analytical methods and are used Bayesian hierarchical models specifically designed for analysis of IMBCR data. We performed all data and output manipulation in R (R Core Team, 2022) and model fitting in JAGS (Plummer 2003, 2017) using the R package jagsUI (Kellner 2018). The R code called the raw data from the IMBCR Structured Query Language (SQL) server database and reformatted the data into a form usable with the JAGS code. We allowed the input of all data collected in a manner consistent with the IMBCR design to increase the number of detections available for estimating global detection rates for population density and site occupancy. The R code provided an automated framework for combining strata-level estimates of population density and site occupancy at multiple spatial scales, as well as estimating the standard deviations and credible intervals for the combined estimates.</p>
<p>We fit initial models to all species with at least 30 detections for density estimation and 10 detections for occupancy estimation. For density estimation, we fit the full model after determining whether there were enough detections based on results from the detection-only model fits. In some cases for both density and occupancy estimation, it was necessary to use a less parsimonious detection structure or simplified model structure to facilitate model convergence. We currently maintain version control of the automated analysis code in the Bird Conservancy repository on www.github.com.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>